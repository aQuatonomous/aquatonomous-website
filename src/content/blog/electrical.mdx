---
draft: false
title: "A Short Circuit Overview: The Internals of Nautical Disaster"
snippet: "A shocking exclusive look at the electrical system of 'Nautical Disaster' and how it manages to move, communicate, and house two large batteries without becoming, well, a Nautical Disaster."
publishDate: "2025-01-27 15:36"
image: {
  src: "https://images.unsplash.com/photo-1565608438257-fac3c27beb36?q=80&w=1176&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
  alt: "Electrical"
}
category: "Update"
author: "Logan Calder, Jai Moraes, Sabrina Button"
tags: [electrical, hardware]
---

Decisions of electrical structure were made to efficiently, safely, and cost effectively allow the control and of the ASV. The electrical system is required to power and apply control to dual thrusters propelling the ASV and respective stepper motors used for steering - read Mechanical's post after [this](/blog/mechanical_overview)! The telemetry system was designed so that the ASV’s propulsion system could be controlled, the ASV could be controlled from the ground station, and the remote emergency stop, and safety protocols could be actuated. The telemetry system has redundant access points so that connection can be ensured at any point. The on-board safety system contains a physical emergency-stop of the boat and has redundant remote emergency stop including remote shutoff of the propulsion system.

# 1 Main Power
### 1.1 Power Calculations
Below in *Table 1* is the expected maximum power draw and current of each of the attached circuits. While these circuits will intertwine, this is only to determine the amount of current and power that will be drawn through the fuse block and thus the batteries. The biggest power sink is the thruster, however bench testing has shown that the current draw of steppers is more likely to be around 10-12 Amps which will increase the expected Battery life to 30-40 minutes.	 The ASV will also never be running at a maximum power draw for 20 minutes, meaning that the battery life is not a risk.
| Component                      | # of Components | Current Draw (A) | Voltage (V) | % Time Active | Power Consumption (W) |
|--------------------------------|-----------------|------------------|-------------|---------------|-----------------------|
| Circuit                        |                 |                  |             | 100%          |                       |
| Telem: PixHawk + Jetson        | 1               | 7                | 5           | 100%          | 36.76                 |
| Wifi Bullet                    | 1               | 0.29             | 24          | 100%          | 8.75                  |
| LiDAR                          | 1               | 0.5              | 12          | 100%          | 7.05                  |
| Signal Tower                   | 1               | 0.167            | 12          | 100%          | 2.35                  |
| HC-12 Nano E-stop              | 1               | 0.33             | 9           | 100%          | 3.00                  |
| T200 Thruster (Theoretical)    | 2               | 22               | 15.26       | 50%           | 335.72                |
| STP-MTR-23055 Stepping Motor   | 2               | 2.8              | 15.26       | 50%           | 42.73                 |
| **Totals:**                    | -               | **57.89**        | -           | -             | **814.81**            |
| **Battery Life (hrs) @ Full pwr** | **0.68**        | **40.7 Minutes** |             |                        |
| **Battery Life (hrs) @ 80% pwr O/P** | **0.85**        | **50.9 Minutes** |             |                        |

The telemetry circuit uses the HolyBro PM02D power module with voltage regulated to 5V using a step-down system. The main line of the module goes directly to the Jetson, with the PixHawk power branching off the control board. Since the PixHawk and the Jetson Nano run in parallel to each other they are on the same circuit from the perspective of the PDM. It’s expected they will pull a combined 4-8A, this includes their own function and all the different sensors, relays, and actuators the Jetson and PixHawk apply power to. The Wi-Fi bullet is on its own power circuit due to its Power Over Ethernet (POE) requirement but is connected to the Jetson for telemetry communication. This connection is explained further in *Section 3 - Telemetry*. The propulsion system is the highest requirement of power of any part of the set up. The wire to the thruster is 10 American Wire Guage (AWG) to handle the higher current. The actuator power is better explained in *Section 5 - Actuators*.
### 1.2 Battery
The ASV is powered by dual [Blue Robotics Lithium Polymer Battery batteries](https://bluerobotics.com/store/comm-control-power/powersupplies-batteries/battery-lp-4s-10ah/) with 10Ah at 14.8V, power capacity at running at Direct Current (DC). Each battery battery is charged to 15.26 V is expected to provide 24 A for an expected power of 366W. The Blue Robotics batteries work for the expected technical requirements but are specifically designed to be flight safe. This makes the transport and application of batteries to compete much more feasible for the team. At the usage voltage of 15.26V there is not a need for grounding if proper precautions are taken. Grounding is meant to stop accidental shorts or shocks from happening, the system is not at a dangerous voltage and will not be touched by any people while the batteries are running. All wiring is expected to be covered by a non-conductive heat shrink and secured. All terminal blocks and the fuse block will be covered by one to two layers of non-conductive plastic to ensure no contact. Batteries will be removed from their fixed attachments with non-conductive plastic outer casing before changes are made to the system.
### 1.3 Wiring Choices and PDM
These system batteries are in a dedicated container attached into the electrical box with wire sized at 12 AWG into a XT-90 to XT-60 adapter with male XT-60 adapter going into ten AWG wire.  Inside the electrical box the positive and negative lines of ten awg wire for both batteries are attached to respective terminal block. The main line is expected to carry a maximum current of 60 Amperes (A), as a result the main line uses seven stranded, 3 awg rated up to 90A copper wire attached with 2 awg lugs these are rated for currents up to 130A. The next nearest wire type is rated below our nominal amperage, therefore the extra surface area for charge to safely pass through as needed. The positive line connects through the main line Solid State Relay (SSR) rated for 100A, into the screw terminal blade fuse block, the ASV’s Power Distribution Module (PDM). The negative bus line of the fuse block connects to the negative terminal block allowing a complete circuit back to the batteries. The is rated for up to 125A and 32V DC and will be running the 9 individual sub-circuits in the ASV of it’s available 12 circuits.  

Our non-technical diagram of this system is shown below in Figure 2. A Technical diagram is available at the bottom of this page.

# 2 Safety System
### 2.1 Physical E-Stop
The physical E-stop system safely shuts off all the power to the system at the push of the button on the side of the boat. All of the circuits run through the main relay, therefore cutting power stops all power distribution circuits. The 9V circuit is also broken, stopping its power draw, therefore the entire system stops. The design of the physical E-Stop is shown below in Figure 3, the lit LED shows that the relay is able to conduct power through it. 

#### Figure 3 - Physical E-Stop
 ![22](https://i.imgur.com/crU9sCM.jpeg)
The button is mounted to the side of the electrical box with drilled holes for wires to pass through. A 9-volt Alkaline battery circuit going through the switch is used as the control voltage for the main relay.
The [switch is only up to 10 ADC](https://www.mcmaster.com/6785K21/), the expected main line current is much above the rated current and would destroy the switch. As a result, the switch is implemented to control a relay that can handle the current demands of the main line. The SSR uses semi-conductor materials that are excited by photons when a control voltage between 3-32V is passed over the control terminals, allowing current to flow. When the button is down, the switch opens causing the control to be de-activated, stopping the flow of current. Compared to photoelectric or electromechanical relays which require a telemetry signal, the simple activation power across the terminals made the SSR an optimal choice for the E-stop. The SSR was also the best price deals for the required voltage and current it needed to handle.  
### 2.2 Relay System for Propulsion
The team found a need to protect the propulsion systems allowing instant shut off power to any or all propulsion components. While normally the component sending commands to the relays will normally cease operations, if there is some sort of issue, the Jetson can act as an emergency power stop to propulsion. Below in Figure 4 is the system of Solid State and Photo-Electric relays combined so that the Jetson can cease power to the motors or steppers.  

#### Figure 4 - Relay System
![23](https://i.imgur.com/7q2zWai.png)
The system of relays is set up so that the power can be cut to the steppers, thruster and controllers whenever needed. The Sainsmart 4 module relay photoelectric relay is attached to four Jetson out pins, corresponding to the four ports on the relay. A 5 volt and ground pin of the Jetson are connected to the VCC and GND pins of the relay ensuring that the Jetson may apply control over the out pins. Due to the variance in current draw of the thrusters, maximum 22A, versus the Steppers, maximum 2.8A, different relays setups are needed. Both stepper powers can travel straight through the relay through the common and normally closed pins, this would disconnect when the relay opens. The steppers require a secondary set of SSR for each rated at 30A and a control between 3-32V. The Jetson 5V out pins travel through the comm and normally closed pins to act as the control voltage of the thruster SSRs. This allows Jetson to control the power of the steppers and thrusters at any point.

### 2.3 Remote E-Stop
The Elgoo Nano E-stop system acts as a redundant method of communicating to the telemetry systems that the current actions need to be stopped. This is built as a combination of Arduino nano and an attached HC-12 SI4463 Wireless Serial Port Module running at 433MHz. One is present both at the ground station and the other on board attached to the Jetson. This can received signal from up to 1000m away at 5000 pbs, which is three times the expected ground station distance in competition. When the proper signal is received stop the actuators using the relay system that dictates the power to them. The small size, low power draw, good price and ease of the Elgoo nano make it ease of implementation with the HC-12 control made it an optimal choice as a redundant communication method.

# 3 Telemetry
### 3.1 Ground Station
To ensure reliable ground station communication with the ASV, aQuatonomous employs four options of communication with overlap to ensure redundancy. The ASV allows communication through it’s Ubiquiti airMAX Wi-Fi  bullets, with Heliumtech 3 dBi LoRaWAN FibreGlass Antennae, Radio control receivers, Sik telemetry radios, and as a last resort Arduino nano’s using HC-12 Wireless controllers which operate via bluetooth at medium range. Some of these communications are used as emergency control, resulting in a priority stucture in which the most used method is not the one with the highest control priority. This is shown in Figure 5.

#### Figure 5: Communication Priority
|**Usage**             |**Control**          |
|---------------------|---------------------|
|*High Use*           |*High Priority*      |
| Wi-fi               | Sik Telemetry Radio |
| RC Radio            | HC-12 Bluetooth     |
| Sik Telemetry Radio | RC Radio            |
| HC-12 Bluetooth     | Wi-fi               |
|*Low Use*            |*Low Priority*       |

### 3.2 PixHawk

The PixHawk 4 is the ASV’s Proportional Integral Derivative (PID) controller. PID controllers can take input data from multiple sensors, using this data it finds the difference between the current point and the desired setpoint. https://www.ni.com/en/shop/labview/pid-theory-explained.html?srsltid=AfmBOorEBwiKdN2CAVxUP_5scUvAewBvMFdn2m8UjoiEN-VMO6OfTB8p. Some of these sensors are the PixHawk’s internal IMU and are connected to the system’s GPS for referencing position. These sensors are explained in more detail in *Section 4.2 Position and Movement*. The PixHawk is directly connected with the Jetson nano to receive navigation instructions and for mutual redundant external communication access, allowing the Jetson nano to be accessed through the PixHawk or vice versa. 
The PixHawk applies Pulse Width Modulation (PWM) signals to control the steppers and thrusters (*[PWM is the practice of sending power in pulses and using the average time on or off as a signal](https://www.sciencedirect.com/topics/engineering/pulse-width-modulation#:~:text=Pulse%20width%20modulation%20(PWM)%20is,of%20an%20analog%20input%20signal.)*). The PWM pin of the PixHawk 4 is attached to a PWM adapter for the stepper drivers and ESCs - their side of the communication is explained further in the Stepper and Thruster sections. Since the PixHawk controls the propulsion, the redundant methods of communication are needed to ensure control can occur at any time.
The PixHawk model will be calibrated using a model of a smaller size ASV package for the resistive forces and speeds of the motors and thrusters. This will involve testing in how the ASV reacts under conditions or the speed at which it travels when the force of the thrusters/stepper are at a measured curve, creating a calibration curve. This is shown in the snippet in Figure 6.

#### Figure 6: PixHawk Wiring Snippet
![PixHawk](https://i.imgur.com/B8g06A0.png)

### 3.3 RC Radio
The RC radio is attached into the PixHawk, it communicates with the MK-12 *remote* on the ground station. This allows the ASV to be remotely steered by the remote, ensuring that the ASV can be maneuvered to the home if other issues are occurring with autonomous direction. The remote will also be used from the ground station as a redundant method of task selection for the ASV to perform.
### 3.4 Sik Telemetry Radio
Sik Radios were specifically designed for autonomous vehicle movement with the PixHawk - intended to be "plug and play". They allow for remote connection from the ground station, and work directly with the Ardupilot remote control software. This allows us to take manual control of the actuation system at any point, overriding the PixHawk's internal navigation settings and steering the boat back to safety in case of a software fault onboard, similar to the RC radio but bypassing the Jetson Nano's control entirely.
### 3.5 Jetson
The Jetson Nano is the brains of the operation - having the teams' autonomous algorithms running on it and will appling them when given the command. The Jetson receives information from the Cameras and LiDAR sensors, explained further in *Section 4 - Sensor Suite*. It is directly connected to the PixHawk and can receive ground station communication directly through the Wi-Fi bullets, or indirectly through the PixHawkawk. The Jetson applies control over the propulsion protection relay system explained in further detail above in *Section 2.2 - Relays*.

![24](data:image/jpeg;base64,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)

### 3.6 WI-FI Bullets
The Ubiquiti airMAX Bullet M2 bullets are the only method of communication that directly connects to the Jetson Nano. It was deemed necessary to have direct communication for direct access, and redundancy if there are any issues communicating with the PixHawk. Wi-Fi bullets have the advantage of allowing for more diverse communication over IP, with multiple senders and receivers. When tracking multiple actuators, data gathering devices, and a full computer vision system, avoiding the overhead of sending these all over one wire by using UDP/TCP is ideal.

They require a voltage of 24 V, implemented with Power Over Ethernet (POE). At the ground station, a 24V UBIQUITI POE Injector - 802.3AF AC-DC adapter is used to employ POE between the ground station computer and Wi-Fi bullet.
On board, an identical Wi-Fi bullet is connected to the Jetson. A POE power splitter is used to power the Wi-Fi bullet receiver the power boost from a 24V step up controller connected to the PDM. Both the ground station and on-board setup are attached to [Heliumtech 3 dBi LoRaWAN Helium 900 MHz Fiberglass Antenna](https://www.expertmobile.ca/shop/ht3lwnf-heliumtech-3-dbi-lorawan-helium-900-mhz-fiberglass-antenna-n-female-5683#attr=) allowing remote log-in from our ground station.


![25](https://m.media-amazon.com/images/I/41Xm1hG06cL.jpg)

# 4 Sensor Suite and System Diagrams/Wiring
### 4.1 Perception: Light Detection and Ranging (LiDAR) and Camera
The Unitree 4D LiDAR L1 and  Camera sensors are connected to the Jetson Nano, providing the ASV information on its surroundings. The LiDAR is connected to Jetson via USB.  

The camera is an ArduCam 12.3MP Module, that will directly connect via USB to the Jetson. It receives power and provides information upon a bundled line. 

The camera supplements the data the LiDAR provides about the location and size of obstacles with further information. The camera provides information that allows object detection software to classify obstacles and confirms obstacle location with the lidar LiDAR. The supplemental information, such as identifying a buoy, and the color of an object, is critical to the team's success in tasks. 

If you are interested in learning how this works in Software, a much more in-depth guide can be found in Perception's Article (here)[/blog/perception_autonomy_overview].

You can also view the connections in our technical diagram at the bottom of this page, or in Figure 6 above.

### 4.2 Position and Movement: Inertial Measurement Unit (IMU) and Global Positioning System (GPS)
The IMU and GPS both work with the PixHawk and are used to determine the ASV’s position, linear and angular velocity, acceleration, and orientation. 

The GPS used is the Holybro M10 GPS. This is externally attached to the PixHawk, it gives the current position of the PixHawk within 2 metres.  Of course - this is meant for non water vehicles. A lot of testing will be focused on determining how waterproofing affects this accuracy, via comparing an exposed GPS on land to our waterproofed HolyBro.

 AQuatonomous’ ASV uses the PixHawk’s internal IMU to determine its current orientation, velocities and acceleration, both angular and linear using its internal [gyroscope](https://docs.px4.io/main/en/sensor/inertial_navigation_systems.html). With the IMU and GPS data, the PixHawk evaluates its current position, and movement to determine the adjustments and actions the propulsion system would need to take to get to the next point of interest - all on its own, taking a great deal of stress off of the Jetson, whose resources are required for our computer vision model. You can learn more about this in [Autonomy's Article](/blog/perception_autonomy_overview).

# 5 Actuator Wiring and Power
To provide motion of the ASV, a stepper and thruster combination is present on both pontoons. The thruster propels the ASV while the stepper controls the rotation of the thruster to change the direction of the ASV as needed. Power to the steppers and thrusters can be stopped at any point by a system of relays controlled by the Jetson described above in *Section 2.2 Relays*.
### 5.1 Blue Robotics T1200 Thrusters
Dual *T1200 thrusters* are used on either side of the ASV’s pontoons to propel the boat in the direction of choice. These are controlled by ESCs (*Electronic Speed Controllers*). These small chips receive signals from the PixHawk and enact PWM control via specialized high-frequency internal relays. This.  The ESC and thruster are rated for maximum of 24A, it is expected that it will pull an average of 14A depending on speed, from bench testing however, this could be closer to 10-15A on average. The nominal voltage for the thrusters is around 16V - the batteries operate at 15.26 which is within 5%. The ESC is connected to the PWM attachment as shown above in Figure 2. They take one control pin routed to the PixHawk, and receive power directly from the block to avoid running high amperage through the PixHawk.

### 5.2 STP-MTR-23055 Stepper Motors
The Bi-Polar, 1.8degree Stepper Motors are in control of the rotations of the thrusters causing a change in direction of the propulsion system. These are rated up to 32V but are able to proficiently rotate the thrusters at 15.26V. These are controlled by A4988 Ponlulu Stepper Driver Controllers. The stepper driver can handle voltages up to 32V at 2.8A. If voltage spikes over 35V occur (which is possible at 12V or higher) the board will be compromised - hence, we use 47uF capacitors to regulate their voltages, protecting the drivers. Using their on-board tuning potentiometer, the current is limited to a maximum of 2.8 A. 

The stepper motor and driver can have both the direction and degrees of rotation controlled. Polarity is important, as an inverse polarity does mean an inversed direction. Luckily this can be fixed via simple calibration or a wire switch after testing. The A4988 stepper driver and motor are wired as shown above in Figure 2. The telemetry of the driver is controlled by the PWM attachment of the PixHawk. The “step” is controlled via PWM, converted to desired degree of rotation by the driver, which uses the Stepper's feedback to correctly drive it to position. Direction is manually sent to the driver via a separate pin, allowing for more control. The stepper driver also requires a control 5V and GND - used both for powe rand as a reference to determine the PWM status.

A snippet of both Motor's wiring is available below in Figure 7:

#### Figure 7: Motor Wiring Snippet
![motor_wiring](https://i.imgur.com/3DIiOZ2.png)


# 6 Bench testing + videos and photos of it!
An effective bench test should be safe, provide clear results in a reasonable timeframe and support meaningful conclusions. Safety is held paramount throughout all design, preparation, and execution. Component performance is evaluated to confirm that the expected method of implementation will work. Testing is compartmentalized to get information about the pieces of each subsystem leading to the overall results.
### 6.1 Propulsion
Before setups are fully built, steppers and thrusters are tested to ensure they function under their expected conditions. This can determine if there are flaws in the setup and give the team information on how they should run it in the future. In thruster motion tests any prolonged motion must be kept under a certain amount unless underwater or it will cause unnecessary strain. Once assembled, the stepper is tested to ensure that under the current power consumption it can rotate the thrusters at over 900 RPM out-of-water. If the stepper cannot, the mechanical mechanism will be altered, or the voltage of the stepper will be boosted. The thruster was tested to determine current draw when powered at 15.26V for different levels of intensity, this is used to calculate power. 

The same will be done with the steppers to determine its expected power drawn from the batteries under different levels of steps. The power draw of all other circuits will be tested to determine the total power draw. This will be used to calculate the empirical power drawn from the batteries and used to evaluate if any of the propulsion will need to be ran at lower speeds to conserve battery health. Once power curves are established and the ASV is functional, the propulsion system will be tested to determine optimal thruster and stepper speed for ASV function. 

As we test, we will occasionally provide updates on this website! Keep your eyes peeled for a blog post soon!

### 6.2 Telemetry
The PWM system with the PixHawk will be tested to ensure that it can control the steppers' direction, speed, and thrusters. The direction that a high or low pulse makes the stepper travel in will be recorded.  speeds achieved by the different pulse width will be tested and recorded to build the PixHawk airframe of the actuators. All communication methods from the ground station will be tested for the expected range that the ASV will be from the ground station and the furthest distance. The Plastic casing should not effect the GPS signal (probably needs a source), but the signal strength will be tested inside the electrical box, versus the outside to ensure that it does not need to be placed outside the box.

### 6.3 Safety System
 The main line physical E-stop has been tested to determine functionality under standard conditions and showed that the circuit opens when the light is pressed. [You can view some tests by clicking here!](https://youtu.be/Dw_cFe_o7-Q?si=tTzQvAe0SovEefy-). The relay system will be tested by originally running power and PWM signals to each of the actuators, then individually turning each off to ensure no shorts, then turning all off at once. If the actuators do not run despite PWM signals being received, the relay system will be deemed successful. The Elgoo HC-12 E-stop system will be tested from the expected distance and maximum distance to ensure it is successful.

 # 7 Full System Diagram

Now viewable below!

 ![26](https://i.imgur.com/FI95vpf.jpeg)